<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ec5b13",
                        "secondary": "#0f4c81",
                        "background-light": "#f2f4f6",
                        "background-dark": "#1a1a1a",
                        "paper": "#ffffff",
                        "paper-dark": "#2d2d2d",
                    },
                    fontFamily: {
                        "display": ["Public Sans", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px" },
                },
            },
        }
    </script>
    <title>PDF Report Preview - Patroli Mandor Line</title>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }

        .preview-scroll::-webkit-scrollbar {
            width: 4px;
        }

        .preview-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .preview-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen pb-24">
    <header
        class="sticky top-0 z-50 bg-background-light dark:bg-background-dark border-b border-slate-200 dark:border-slate-700 px-4 py-4 backdrop-blur-md bg-opacity-90">
        <div class="flex items-center justify-between max-w-md mx-auto">
            <button onclick="history.back()"
                class="p-2 -ml-2 text-slate-700 dark:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-700/50 rounded-full transition-colors">
                <span class="material-symbols-outlined">arrow_back</span>
            </button>
            <h1
                class="text-sm font-bold uppercase tracking-wider text-center flex-1 truncate px-2 text-slate-800 dark:text-white">
                Preview Laporan
            </h1>
            <button
                class="p-2 -mr-2 text-slate-700 dark:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-700/50 rounded-full transition-colors">
                <span class="material-symbols-outlined">more_vert</span>
            </button>
        </div>
    </header>
    <main class="max-w-md mx-auto p-4">
        <div
            class="bg-paper dark:bg-paper-dark shadow-xl rounded-none sm:rounded-lg overflow-hidden border border-slate-200 dark:border-slate-700 relative">
            <div class="bg-secondary text-white p-5 border-b-4 border-primary relative overflow-hidden">
                <div
                    class="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-10 -mt-10 pointer-events-none">
                </div>
                <div class="flex justify-between items-start mb-4">
                    <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center backdrop-blur-sm">
                        <span class="material-symbols-outlined text-3xl">bolt</span>
                    </div>
                    <div class="text-right">
                        <div class="text-[10px] uppercase opacity-70 tracking-widest">Report ID</div>
                        <div class="font-mono text-sm font-bold" id="previewNoKondisi">HAR250226.001</div>
                    </div>
                </div>
                <h2 class="text-lg font-bold uppercase tracking-wide leading-tight">Laporan Patroli<br />Mandor Line
                </h2>
            </div>
            <div class="p-5 space-y-6 text-sm text-slate-700 dark:text-slate-300">
                <section class="border-b border-slate-100 dark:border-slate-600 pb-4">
                    <h3
                        class="text-xs font-bold text-secondary dark:text-sky-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">badge</span> Petugas &amp; Lokasi
                    </h3>
                    <div class="grid grid-cols-2 gap-y-3 gap-x-2">
                        <div>
                            <div class="text-[10px] text-slate-400 uppercase">Nama Petugas</div>
                            <div class="font-semibold uppercase truncate" id="previewNama">-</div>
                        </div>
                        <div>
                            <div class="text-[10px] text-slate-400 uppercase">Waktu Patroli</div>
                            <div class="font-medium" id="previewWaktu">-</div>
                        </div>
                        <div class="col-span-2">
                            <div class="text-[10px] text-slate-400 uppercase">Lokasi (Penyulang - Segmen)</div>
                            <div
                                class="font-medium bg-slate-50 dark:bg-slate-800 p-2 rounded border border-slate-100 dark:border-slate-600 flex items-center">
                                <span class="material-symbols-outlined text-primary text-sm mr-2">location_on</span>
                                <span id="previewLokasi">-</span>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="border-b border-slate-100 dark:border-slate-600 pb-4">
                    <h3
                        class="text-xs font-bold text-secondary dark:text-sky-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">search</span> Temuan Lapangan
                    </h3>
                    <div class="mb-3">
                        <div class="text-[10px] text-slate-400 uppercase mb-1">Deskripsi Temuan</div>
                        <p id="previewTemuan"
                            class="leading-relaxed text-slate-800 dark:text-slate-200 bg-orange-50 dark:bg-orange-900/10 p-2 rounded-lg border border-orange-100 dark:border-orange-800/30 text-xs">
                            -
                        </p>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <div
                            class="aspect-square bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden relative group">
                            <img alt="Foto Temuan 1" id="previewFoto1" class="w-full h-full object-cover opacity-90"
                                src="" />
                            <div
                                class="absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 text-center backdrop-blur-sm">
                                Foto Temuan 1
                            </div>
                        </div>
                        <div
                            class="aspect-square bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden relative group">
                            <img alt="Foto Temuan 2" id="previewFoto2" class="w-full h-full object-cover opacity-90"
                                src="" />
                            <div
                                class="absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 text-center backdrop-blur-sm">
                                Foto Temuan 2
                            </div>
                        </div>
                    </div>
                    <!-- Map Placeholder -->
                    <div
                        class="rounded-lg overflow-hidden border border-slate-200 dark:border-slate-600 h-24 relative bg-slate-100">
                        <div class="absolute inset-0 bg-slate-200 dark:bg-slate-700 opacity-20"
                            style="background-image: radial-gradient(#94a3b8 1px, transparent 1px); background-size: 10px 10px;">
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="bg-red-500 text-white p-1 rounded-full shadow-lg animate-pulse">
                                <span class="material-symbols-outlined text-sm block">my_location</span>
                            </div>
                        </div>
                        <div
                            class="absolute bottom-1 right-1 bg-white/80 dark:bg-black/60 text-[8px] px-1 rounded text-slate-600 dark:text-slate-300">
                            Coordinate captured
                        </div>
                    </div>
                </section>
                <section class="border-b border-slate-100 dark:border-slate-600 pb-4">
                    <h3
                        class="text-xs font-bold text-secondary dark:text-sky-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">build</span> Tindak Lanjut
                    </h3>
                    <div class="flex gap-2 mb-3">
                        <div
                            class="flex-1 bg-slate-50 dark:bg-slate-800 p-2 rounded border border-slate-100 dark:border-slate-700 text-center">
                            <div class="text-[9px] text-slate-400 uppercase">Prioritas</div>
                            <div class="text-red-500 font-bold text-lg flex justify-center items-center gap-1">
                                <span class="material-symbols-outlined text-sm">warning</span> <span
                                    id="previewPrioritas">1</span>
                            </div>
                        </div>
                        <div
                            class="flex-1 bg-slate-50 dark:bg-slate-800 p-2 rounded border border-slate-100 dark:border-slate-700 text-center">
                            <div class="text-[9px] text-slate-400 uppercase">Status</div>
                            <div class="text-green-600 font-bold text-sm uppercase mt-1" id="previewStatus">Selesai
                            </div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-3 mb-2">
                        <div>
                            <div class="text-[10px] text-slate-400 uppercase">Tgl Tindak Lanjut</div>
                            <div class="font-medium text-xs" id="previewTglTindak">-</div>
                        </div>
                        <div>
                            <div class="text-[10px] text-slate-400 uppercase">Pelaksana</div>
                            <div class="font-medium text-xs" id="previewPelaksana">-</div>
                        </div>
                    </div>
                </section>
                <section>
                    <h3
                        class="text-xs font-bold text-secondary dark:text-sky-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">assignment_turned_in</span> Validasi
                    </h3>
                    <div class="flex gap-3">
                        <div
                            class="w-1/3 aspect-[3/4] bg-slate-200 dark:bg-slate-700 rounded-lg overflow-hidden relative">
                            <img alt="Hasil Perbaikan" id="previewFotoAction"
                                class="w-full h-full object-cover opacity-90" src="" />
                            <div class="absolute bottom-0 w-full bg-black/60 text-white text-[8px] p-1 text-center">
                                Foto Hasil
                            </div>
                        </div>
                        <div
                            class="flex-1 flex flex-col justify-between border border-slate-200 dark:border-slate-600 rounded-lg p-3 bg-slate-50 dark:bg-slate-800/50">
                            <div class="text-[10px] text-slate-500 uppercase text-center mb-4">Tanda Tangan Petugas
                            </div>
                            <div class="flex-1 flex items-center justify-center">
                                <svg class="w-24 h-12 opacity-70 stroke-secondary dark:stroke-sky-400 fill-none"
                                    stroke-linecap="round" stroke-width="2" viewBox="0 0 200 60">
                                    <path
                                        d="M10,40 C30,40 30,20 50,20 C70,20 70,50 90,30 C110,10 130,50 150,40 S 180,30 190,40">
                                    </path>
                                </svg>
                            </div>
                            <div class="border-t border-slate-300 dark:border-slate-500 pt-1 mt-2 text-center">
                                <div class="text-[10px] font-bold uppercase" id="previewSignatureName">-</div>
                                <div class="text-[8px] text-slate-400">Petugas Lapangan</div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="bg-slate-50 dark:bg-slate-800 p-3 text-center border-t border-slate-200 dark:border-slate-700">
                <p class="text-[10px] text-slate-400">Dokumen dipreview secara otomatis berdasarkan data yang diinput.
                </p>
            </div>
        </div>
    </main>
    <div
        class="fixed bottom-0 left-0 right-0 bg-background-light dark:bg-background-dark p-4 border-t border-slate-200 dark:border-slate-700 bg-opacity-95 backdrop-blur-sm z-40">
        <div class="max-w-md mx-auto flex gap-3">
            <button onclick="window.location.href='patroli-step1.html'"
                class="flex-1 h-12 bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600 text-slate-700 dark:text-white font-semibold rounded-xl border border-slate-200 dark:border-slate-600 shadow-sm flex items-center justify-center gap-2 transition-transform active:scale-95">
                <span class="material-symbols-outlined text-xl">home</span>
                <span>Selesai</span>
            </button>
            <button onclick="window.print()"
                class="flex-1 h-12 bg-primary hover:bg-primary/90 text-white font-bold rounded-xl shadow-lg shadow-primary/20 flex items-center justify-center gap-2 transition-transform active:scale-95">
                <span class="material-symbols-outlined text-xl">download</span>
                <span>Download PDF</span>
            </button>
        </div>
    </div>

    <script>
        // Load data from Session Storage
        window.onload = function () {
            document.getElementById('previewNoKondisi').textContent = sessionStorage.getItem('step1_noKondisi') || 'HAR-XXXX';
            document.getElementById('previewNama').textContent = sessionStorage.getItem('step1_nama') || '-';
            document.getElementById('previewWaktu').textContent = sessionStorage.getItem('step1_waktu') || '-';
            document.getElementById('previewLokasi').textContent = (sessionStorage.getItem('step1_penyulang') || '-') + ' - ' + (sessionStorage.getItem('step1_segmen') || '-');
            document.getElementById('previewTemuan').textContent = sessionStorage.getItem('step2_jenisTemuan') + ': ' + sessionStorage.getItem('step2_keterangan');

            document.getElementById('previewFoto1').src = sessionStorage.getItem('step2_foto1') || '';
            document.getElementById('previewFoto2').src = sessionStorage.getItem('step2_foto2') || '';
            document.getElementById('previewFotoAction').src = sessionStorage.getItem('step3_fotoAction') || '';

            document.getElementById('previewPrioritas').textContent = sessionStorage.getItem('last_prioritas') || '1';
            document.getElementById('previewStatus').textContent = sessionStorage.getItem('last_status') || 'OPEN';
            document.getElementById('previewPelaksana').textContent = sessionStorage.getItem('last_pelaksana') || '-';
            document.getElementById('previewSignatureName').textContent = sessionStorage.getItem('step1_nama') || 'PETUGAS';

            // Date for Tindak Lanjut (current date)
            const now = new Date();
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            document.getElementById('previewTglTindak').textContent = `${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
        };
    </script>

</body>

</html>